<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:amq="http://activemq.apache.org/schema/core"
	xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:jms="http://www.springframework.org/schema/jms"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
		http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
		http://www.springframework.org/schema/aop
		http://www.springframework.org/schema/aop/spring-aop-3.1.xsd
		http://activemq.apache.org/schema/core
		http://activemq.apache.org/schema/core/activemq-core-5.5.0.xsd
		http://www.springframework.org/schema/jms
		http://www.springframework.org/schema/jms/spring-jms-3.1.xsd">

	<bean id="jmsFactory" class="org.apache.activemq.pool.PooledConnectionFactory">
		<property name="connectionFactory">
			<bean class="org.apache.activemq.ActiveMQConnectionFactory">
				<property name="brokerURL" value="tcp://121.40.121.133:61616" />
			</bean>
		</property>
	</bean>
	<bean class="org.springframework.jms.connection.CachingConnectionFactory" id="cachingConnectionFactory">
		<property name="targetConnectionFactory">
			<ref local="jmsFactory" />
		</property>
	</bean>
	<bean class="org.springframework.jms.core.JmsTemplate" id="jmsTemplate">
		<property name="connectionFactory" ref="cachingConnectionFactory" />
		<property name="defaultDestination" ref="QUEUE" />
	</bean>
	<amq:topic name="TOPIC" physicalName="JMS-TOPIC" />
	<amq:queue name="QUEUE" physicalName="JMS-QUEUE" />
    <bean id="topicMessageProducer" class="com.sw.activemq.JmsProducer">
        <property name="destination" ref="TOPIC" />
    </bean>
    <bean id="queueMessageProducer" class="com.sw.activemq.JmsProducer">
        <property name="destination" ref="QUEUE" />
    </bean>
    <jms:listener-container connection-factory="jmsFactory" destination-type="queue">
        <jms:listener destination="TOPIC"
                      method="onMessage"
                      ref="jmsQueueListener" />
    </jms:listener-container>

    <jms:listener-container connection-factory="jmsFactory" destination-type="topic">
        <jms:listener destination="QUEUE"
                      method="onMessage"
                      ref="jmsTopicListener" />
    </jms:listener-container>

    <bean id="jmsQueueListener"  class="com.sw.activemq.JmsListener"/>
    <bean id="jmsTopicListener"  class="com.sw.activemq.JmsListener"/>

</beans>
